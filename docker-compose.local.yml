services:
  # Servicio Backend LOCAL con hot-reloading
  backend:
    build:
      context: ./backend  # Ruta a la carpeta con tu Dockerfile
      dockerfile: Dockerfile
    container_name: taskpro-backend-local
    ports:
      - "8000:8000"
    volumes:
      # Monta tu código local para que el hot-reloading funcione
      - ./backend/app:/app
      # Montar la llave de Google Cloud (asumiendo que está en ./config)
      - ./config/primeval-falcon-474622-h1-d5121477addc.json:/app/config/gcloud-key.json:ro
    environment:
      # Carga las variables del archivo .env
      - DATABASE_URL=${DATABASE_URL}
      - GOOGLE_GENAI_USE_VERTEXAI=True
      - GOOGLE_APPLICATION_CREDENTIALS=/app/config/gcloud-key.json
      - GOOGLE_CLOUD_PROJECT=${GOOGLE_CLOUD_PROJECT}
      - GOOGLE_CLOUD_LOCATION=${GOOGLE_CLOUD_LOCATION}
      - GOOGLE_API_KEY=${GOOGLE_API_KEY}
    command: uvicorn main:app --host 0.0.0.0 --port 8000 --reload
    # No se necesita 'networks' ni 'depends_on', 
    # usará la red bridge por defecto para salir a internet.