# üìã TaskPro - Documentaci√≥n T√©cnica Empresarial

> **Plataforma Inteligente de Conexi√≥n de Servicios Profesionales**  
> Desarrollado para Globant | Arquitectura A2A + MCP + LLM  
> Versi√≥n: 1.0.0 | Fecha: Octubre 2025

---

## üìë Tabla de Contenidos

1. [Visi√≥n General del Proyecto](#-visi√≥n-general-del-proyecto)
2. [Arquitectura del Sistema](#-arquitectura-del-sistema)
3. [Backend - Sistema de Agentes A2A](#-backend---sistema-de-agentes-inteligentes)
4. [Model Context Protocol (MCP)](#-integraci√≥n-mcp-model-context-protocol)
5. [Servicio LLM y Gemini](#-servicio-llm-gemini-integration)
6. [Base de Datos y Modelos](#-base-de-datos-postgresql)
7. [Frontend - Interfaz React](#-frontend---interfaz-de-usuario-moderna)
8. [Seguridad y Compliance](#-seguridad-y-compliance-empresarial)
9. [Flujos Complejos End-to-End](#-flujos-complejos-end-to-end)
10. [Escalabilidad y Performance](#-escalabilidad-y-performance)
11. [Monitoreo y Observabilidad](#-monitoreo-y-observabilidad)
12. [Despliegue y DevOps](#-despliegue-y-devops)

---

## üåü Visi√≥n General del Proyecto

### Problema de Negocio

En Am√©rica Latina, **millones de usuarios** requieren servicios t√©cnicos urgentes (plomer√≠a, electricidad, reparaciones) pero enfrentan:

- ‚ùå **Falta de confianza**: No saben si el t√©cnico es calificado
- ‚ùå **Precios opacos**: Cotizaciones abusivas sin transparencia
- ‚ùå **B√∫squeda ineficiente**: Llamadas a m√∫ltiples contactos sin resultados
- ‚ùå **Urgencia no atendida**: Problemas cr√≠ticos sin resoluci√≥n inmediata

### Soluci√≥n Tecnol√≥gica

**TaskPro** es una plataforma enterprise que utiliza **Inteligencia Artificial Generativa** y **arquitectura de agentes especializados** para:

‚úÖ **Interpretar lenguaje natural**: El usuario describe su problema como habla  
‚úÖ **Clasificar autom√°ticamente**: IA identifica el oficio correcto (25+ categor√≠as)  
‚úÖ **Recomendar inteligentemente**: Algoritmo ML rankea t√©cnicos por relevancia  
‚úÖ **Garantizar seguridad**: Sistema Guardian detecta fraudes y precios an√≥malos  
‚úÖ **Transparentar decisiones**: Cada recomendaci√≥n tiene explicaci√≥n clara  

### Diferenciadores Clave

| Caracter√≠stica | TaskPro | Competencia Tradicional |
|----------------|---------|-------------------------|
| **Entrada del usuario** | Lenguaje natural con IA | Formularios r√≠gidos |
| **Clasificaci√≥n** | Autom√°tica (Gemini 2.5) | Manual o keywords |
| **Recomendaciones** | A2A multi-agente | Filtros simples |
| **Detecci√≥n de fraudes** | Agente Guardian con LLM | Reportes reactivos |
| **Transparencia** | Explicaciones generadas | Caja negra |
| **Arquitectura** | MCP + A2A escalable | Monol√≠tica |

### Tecnolog√≠as Core

- **Backend**: FastAPI (Python 3.11) - Performance de 20,000 req/s
- **IA**: Google Gemini 2.5 Flash - Latencia <800ms por an√°lisis
- **Protocolo**: MCP (Model Context Protocol) - Est√°ndar Anthropic
- **Frontend**: Next.js 15 + TypeScript - SSR y SSG h√≠brido
- **Base de Datos**: PostgreSQL 16 - Modelo relacional normalizado
- **Infraestructura**: Docker + Kubernetes - Auto-scaling horizontal

---

## üèóÔ∏è Arquitectura del Sistema

### Diagrama de Alto Nivel


```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                          CAPA DE PRESENTACI√ìN                               ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ  Claude Desktop  ‚îÇ  ‚îÇ  Web Browser     ‚îÇ  ‚îÇ  Mobile App (Futuro)     ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  (MCP Client)    ‚îÇ  ‚îÇ  (React SPA)     ‚îÇ  ‚îÇ  (React Native)          ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
            ‚îÇ stdio/MCP          ‚îÇ HTTPS/REST         ‚îÇ HTTPS/REST + WSS
            ‚îÇ                    ‚îÇ                    ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                         CAPA DE APLICACI√ìN                               ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ              MCP SERVER (Model Context Protocol)                   ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  Tools Expostas:                                             ‚îÇ ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  ‚Ä¢ analyze_solicitud       ‚Üí Agente Analista                 ‚îÇ ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  ‚Ä¢ create_solicitud        ‚Üí Agente Estructurador            ‚îÇ ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  ‚Ä¢ procesar_completa       ‚Üí Orquestador A2A Pipeline       ‚îÇ ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ                                ‚îÇ HTTP/REST (Internal Network)            ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ                 BACKEND API (FastAPI)                              ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  PIPELINE DE AGENTES A2A (Agent-to-Agent)                    ‚îÇ ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ                                                               ‚îÇ ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                   ‚îÇ ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ 1. AGENTE      ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ 2. AGENTE      ‚îÇ                   ‚îÇ ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ    ANALISTA    ‚îÇ    ‚îÇ   RECOMENDADOR ‚îÇ                   ‚îÇ ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ (Gemini LLM)   ‚îÇ    ‚îÇ  (ML + SQL)    ‚îÇ                   ‚îÇ ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                   ‚îÇ ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ           ‚îÇ                      ‚îÇ                           ‚îÇ ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ           ‚îÇ   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê        ‚îÇ ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ           ‚îÇ   ‚îÇ                                      ‚îÇ        ‚îÇ ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ           ‚ñº   ‚ñº                                      ‚ñº        ‚îÇ ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê‚îÇ ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ 3. AGENTE      ‚îÇ                        ‚îÇ 4. AGENTE      ‚îÇ‚îÇ ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ   GUARDI√ÅN     ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂ ‚îÇ  ORQUESTADOR   ‚îÇ‚îÇ ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ (Gemini LLM)   ‚îÇ   Alertas + Decisi√≥n   ‚îÇ  (Decisi√≥n)    ‚îÇ‚îÇ ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò‚îÇ ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ                                                               ‚îÇ ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ ‚îÇ
‚îÇ  ‚îÇ                                                                     ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  SERVICIOS AUXILIARES                                        ‚îÇ ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  ‚Ä¢ llm_service.py     ‚Üí Interface Gemini + Function Calling ‚îÇ ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  ‚Ä¢ database.py        ‚Üí ORM SQLAlchemy + Connection Pool    ‚îÇ ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  ‚Ä¢ models.py          ‚Üí Pydantic Schemas (Validaci√≥n)       ‚îÇ ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  ‚Ä¢ auth_service.py    ‚Üí JWT + OAuth2 (WIP)                  ‚îÇ ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  ‚Ä¢ cache_service.py   ‚Üí Redis (WIP)                         ‚îÇ ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                         CAPA DE SERVICIOS EXTERNOS                       ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ  Google Gemini  ‚îÇ    ‚îÇ  PostgreSQL 16  ‚îÇ    ‚îÇ  Redis Cache       ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  2.5 Flash      ‚îÇ    ‚îÇ  (Primary DB)   ‚îÇ    ‚îÇ  (Sessions)        ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  ‚Ä¢ Vertex AI    ‚îÇ    ‚îÇ  13 Tablas      ‚îÇ    ‚îÇ  TTL: 3600s        ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  ‚Ä¢ API Key      ‚îÇ    ‚îÇ  Connection     ‚îÇ    ‚îÇ  Memoria: 2GB      ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  ADC Auth       ‚îÇ    ‚îÇ  Pool: 20       ‚îÇ    ‚îÇ  Persist: No       ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

                           ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                           ‚îÇ  CAPA DE MONITOREO   ‚îÇ
                           ‚îÇ  ‚Ä¢ Prometheus        ‚îÇ
                           ‚îÇ  ‚Ä¢ Grafana           ‚îÇ
                           ‚îÇ  ‚Ä¢ Elastic APM       ‚îÇ
                           ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Principios Arquitect√≥nicos

#### 1. **Separaci√≥n de Responsabilidades (SoC)**
Cada agente tiene un rol √∫nico y bien definido:
- **Analista**: Comprensi√≥n del lenguaje natural
- **Recomendador**: B√∫squeda y ranking
- **Guardi√°n**: Seguridad y compliance
- **Orquestador**: Coordinaci√≥n y decisi√≥n final

#### 2. **Comunicaci√≥n As√≠ncrona**
- Uso de `async/await` en Python para I/O no bloqueante
- Connection pooling para DB (20 conexiones concurrentes)
- Timeouts configurables (30s para LLM, 5s para DB)

#### 3. **Escalabilidad Horizontal**
- Stateless backend (sesiones en Redis)
- Load balancing con Nginx
- Auto-scaling basado en CPU/Memoria (K8s HPA)

#### 4. **Fail-Safe y Resilience**
- Circuit breakers para llamadas a Gemini (3 reintentos)
- Fallbacks: Si Gemini falla, usar clasificador local (scikit-learn)
- Health checks cada 30 segundos

#### 5. **Seguridad por Dise√±o**
- Principio de menor privilegio (RBAC)
- Encriptaci√≥n en tr√°nsito (TLS 1.3)
- Sanitizaci√≥n de inputs (Pydantic validators)
- Rate limiting: 100 req/min por IP

---

## üîß BACKEND - Sistema de Agentes Inteligentes

### üìÇ Estructura del Backend

```
backend/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ main.py                    # Endpoints FastAPI (Orquestaci√≥n)
‚îÇ   ‚îú‚îÄ‚îÄ llm_service.py             # L√≥gica de agentes LLM (1200+ l√≠neas)
‚îÇ   ‚îú‚îÄ‚îÄ database.py                # Modelos SQLAlchemy (13 tablas)
‚îÇ   ‚îú‚îÄ‚îÄ models.py                  # Pydantic Schemas (Validaci√≥n)
‚îÇ   ‚îú‚îÄ‚îÄ auth_service.py            # JWT + OAuth2 (WIP)
‚îÇ   ‚îú‚îÄ‚îÄ cache_service.py           # Redis wrapper (WIP)
‚îÇ   ‚îî‚îÄ‚îÄ config/
‚îÇ       ‚îú‚îÄ‚îÄ gcloud-key.json        # Service Account GCP
‚îÇ       ‚îî‚îÄ‚îÄ settings.py            # Configuraci√≥n centralizada
‚îú‚îÄ‚îÄ tests/
‚îÇ   ‚îú‚îÄ‚îÄ test_agents.py             # Unit tests agentes
‚îÇ   ‚îú‚îÄ‚îÄ test_integration.py        # Integration tests E2E
‚îÇ   ‚îî‚îÄ‚îÄ test_security.py           # Penetration tests
‚îú‚îÄ‚îÄ migrations/                     # Alembic DB migrations
‚îÇ   ‚îî‚îÄ‚îÄ versions/
‚îú‚îÄ‚îÄ Dockerfile                      # Multi-stage build
‚îú‚îÄ‚îÄ requirements.txt                # Dependencias pinned
‚îú‚îÄ‚îÄ .dockerignore
‚îî‚îÄ‚îÄ pytest.ini
```

### üß† Sistema de Agentes A2A (Agent to Agent)

#### üéØ Concepto de A2A

La arquitectura **Agent-to-Agent** es un patr√≥n de dise√±o donde **m√∫ltiples agentes especializados colaboran** para resolver un problema complejo. Cada agente:

1. **Tiene un dominio de expertise**: An√°lisis, recomendaci√≥n, seguridad, etc.
2. **Recibe contexto estructurado**: JSON con datos relevantes para su tarea
3. **Produce salida tipada**: Schemas Pydantic para garantizar consistencia
4. **Pasa contexto al siguiente agente**: Pipeline secuencial con checkpoints
5. **Es independiente y testeable**: Unit tests aislados por agente

**Ventajas sobre monol√≠tico**:
- ‚úÖ **Modularidad**: Cambiar un agente sin afectar otros
- ‚úÖ **Testabilidad**: Probar l√≥gica de cada agente aisladamente
- ‚úÖ **Escalabilidad**: Distribuir agentes en diferentes pods/servicios
- ‚úÖ **Transparencia**: Ver decisi√≥n de cada agente en logs
- ‚úÖ **Mantenibilidad**: C√≥digo m√°s legible y organizado

#### üåä Pipeline Completo A2A

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    ENTRADA DEL USUARIO                           ‚îÇ
‚îÇ  "Necesito un plomero urgente, se rompi√≥ mi inodoro"           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                             ‚îÇ
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ  üîç AGENTE 1:   ‚îÇ
                    ‚îÇ    ANALISTA     ‚îÇ
                    ‚îÇ                 ‚îÇ
                    ‚îÇ  ‚Ä¢ Clasifica    ‚îÇ
                    ‚îÇ  ‚Ä¢ Extrae info  ‚îÇ
                    ‚îÇ  ‚Ä¢ Prioriza     ‚îÇ
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                             ‚îÇ
                 ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                 ‚îÇ  Contexto Estructurado ‚îÇ
                 ‚îÇ  - Oficio: Plomer√≠a   ‚îÇ
                 ‚îÇ  - Urgencia: Alta     ‚îÇ
                 ‚îÇ  - Precio: $50-100    ‚îÇ
                 ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                             ‚îÇ
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ  üéØ AGENTE 2:   ‚îÇ
                    ‚îÇ  RECOMENDADOR   ‚îÇ
                    ‚îÇ                 ‚îÇ
                    ‚îÇ  ‚Ä¢ Busca BD     ‚îÇ
                    ‚îÇ  ‚Ä¢ Filtra       ‚îÇ
                    ‚îÇ  ‚Ä¢ Rankea       ‚îÇ
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                             ‚îÇ
                 ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                 ‚îÇ  Lista de Candidatos  ‚îÇ
                 ‚îÇ  - Carlos (5‚≠ê, 2km)  ‚îÇ
                 ‚îÇ  - Ana (4.8‚≠ê, 3km)   ‚îÇ
                 ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                             ‚îÇ
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ  üõ°Ô∏è AGENTE 3:   ‚îÇ
                    ‚îÇ   GUARDI√ÅN      ‚îÇ
                    ‚îÇ                 ‚îÇ
                    ‚îÇ  ‚Ä¢ Detecta      ‚îÇ
                    ‚îÇ  ‚Ä¢ Valida       ‚îÇ
                    ‚îÇ  ‚Ä¢ Alerta       ‚îÇ
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                             ‚îÇ
                 ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                 ‚îÇ  An√°lisis de Riesgo   ‚îÇ
                 ‚îÇ  - Sin alertas        ‚îÇ
                 ‚îÇ  - Precios OK         ‚îÇ
                 ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                             ‚îÇ
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ  üß† AGENTE 4:   ‚îÇ
                    ‚îÇ  ORQUESTADOR    ‚îÇ
                    ‚îÇ                 ‚îÇ
                    ‚îÇ  ‚Ä¢ Decide       ‚îÇ
                    ‚îÇ  ‚Ä¢ Coordina     ‚îÇ
                    ‚îÇ  ‚Ä¢ Responde     ‚îÇ
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                             ‚îÇ
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ  RESULTADO      ‚îÇ
                    ‚îÇ  FINAL AL USER  ‚îÇ
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## ü§ñ Detalle de Cada Agente

### 1. üîç **Agente Analista** (`analizar_solicitud`)

**Responsabilidad**: Interpretar lenguaje natural y estructurar la solicitud.

**Entrada**:
```json
{
  "texto_usuario": "Necesito un plomero urgente, se rompi√≥ mi inodoro"
}
```

**Procesamiento**:
- **LLM (Gemini 2.0 Flash)** interpreta el texto
- Consulta cat√°logo de oficios en BD
- Clasifica seg√∫n categor√≠a (Plomer√≠a, Electricidad, etc.)
- Extrae urgencia (baja, media, alta)
- Estima precio de mercado
- Genera preguntas aclaratorias

**Salida**:
```json
{
  "id_oficio": 5,
  "nombre_oficio": "Plomero",
  "urgencia": "alta",
  "precio_estimado": "$50 - $100",
  "explicacion": "Se identific√≥ una emergencia de plomer√≠a...",
  "preguntas_aclaratorias": ["¬øHay fuga de agua activa?"],
  "nivel_confianza": 0.95
}
```

**C√≥digo clave** (`llm_service.py`):
```python
async def analizar_solicitud(
    texto_usuario_original: str,
    oficios_disponibles: str
) -> AnalisisOutput:
    prompt = f"""
    Eres un Agente Analista experto en clasificaci√≥n de servicios.
    
    OFICIOS DISPONIBLES:
    {oficios_disponibles}
    
    SOLICITUD DEL USUARIO:
    {texto_usuario_original}
    
    TAREAS:
    1. Identifica el oficio m√°s apropiado
    2. Determina urgencia (baja/media/alta)
    3. Estima precio de mercado
    4. Genera preguntas aclaratorias
    """
    
    # Llamada a Gemini con Function Calling
    response = client.models.generate_content(
        model='gemini-2.0-flash-exp',
        contents=prompt,
        config=config
    )
    
    return AnalisisOutput(**response.parsed)
```

---

### 2. üéØ **Agente Recomendador** (`recomendar_trabajadores`)

**Responsabilidad**: Buscar y rankear t√©cnicos seg√∫n criterios m√∫ltiples.

**Entrada**:
```json
{
  "id_oficio": 5,
  "id_ciudad": 1,
  "id_barrio": 10,
  "urgencia": "alta"
}
```

**Procesamiento**:
- Consulta BD con filtros (oficio, ubicaci√≥n, disponibilidad)
- Calcula distancia geogr√°fica
- Pondera calificaci√≥n promedio
- Considera experiencia y servicios completados
- Rankea usando **algoritmo de scoring**

**Algoritmo de Ranking**:
```
Score = (Calificaci√≥n √ó 30) + (Distancia_Inv √ó 25) + (Experiencia √ó 20) + 
        (Servicios √ó 15) + (Disponibilidad √ó 10)

Donde:
- Calificaci√≥n: 0-5 estrellas
- Distancia_Inv: 1 / (distancia_km + 1)
- Experiencia: a√±os en la plataforma
- Servicios: cantidad de trabajos completados
- Disponibilidad: boolean (0 o 100 puntos)
```

**Salida**:
```json
{
  "trabajadores_recomendados": [
    {
      "id_trabajador": 42,
      "nombre": "Carlos P√©rez",
      "calificacion_promedio": 4.9,
      "distancia_km": 2.3,
      "precio_promedio": "$75",
      "disponibilidad": true,
      "score_recomendacion": 92.5
    }
  ],
  "criterios_aplicados": ["ubicacion", "calificacion", "urgencia"]
}
```

---

### 3. üõ°Ô∏è **Agente Guardi√°n** (`detectar_alertas`)

**Responsabilidad**: Seguridad, detecci√≥n de fraudes y precios an√≥malos.

**Entrada**:
```json
{
  "texto_usuario": "Necesito un plomero urgente",
  "trabajadores_recomendados": [...],
  "precio_estimado": "$50-100"
}
```

**Procesamiento LLM**:
- **An√°lisis de sentimiento** (detecta desesperaci√≥n)
- **Validaci√≥n de precios** (outliers estad√≠sticos)
- **Patrones sospechosos** (horarios extra√±os, m√∫ltiples solicitudes)
- **Verificaci√≥n de datos** (tel√©fonos, direcciones)

**Tipos de Alertas**:
```python
TipoAlerta = Literal[
    'precio_anomalo',      # Precio 50% > mercado
    'urgencia_sospechosa', # Presi√≥n temporal
    'datos_incompletos',   # Falta info cr√≠tica
    'patron_fraude',       # Comportamiento an√≥malo
    'trabajador_reportado' # Historial negativo
]
```

**Salida**:
```json
{
  "alertas": [
    {
      "tipo": "precio_anomalo",
      "severidad": "media",
      "descripcion": "Carlos cotiza $150, precio promedio es $75",
      "accion_sugerida": "Solicitar justificaci√≥n del precio"
    }
  ],
  "nivel_riesgo_general": "bajo",
  "recomendacion_proceder": true
}
```

---

### 4. üß† **Agente Orquestador** (`procesar_solicitud_completa`)

**Responsabilidad**: Coordinar pipeline completo y tomar decisi√≥n final.

**Flujo de Ejecuci√≥n**:
```python
async def procesar_solicitud_completa(
    texto_usuario: str,
    id_ciudad: int,
    id_barrio: int,
    db: Session
) -> ProcesamientoCompletoOutput:
    
    # PASO 1: Llamar al Agente Analista
    analisis = await analizar_solicitud(
        texto_usuario, 
        oficios_disponibles
    )
    
    # PASO 2: Llamar al Agente Recomendador
    recomendaciones = await recomendar_trabajadores(
        id_oficio=analisis.id_oficio,
        id_ciudad=id_ciudad,
        urgencia=analisis.urgencia
    )
    
    # PASO 3: Llamar al Agente Guardi√°n
    alertas = await detectar_alertas(
        texto_usuario=texto_usuario,
        trabajadores=recomendaciones.trabajadores,
        precio_estimado=analisis.precio_estimado
    )
    
    # PASO 4: Tomar Decisi√≥n
    decision = tomar_decision_final(
        analisis, 
        recomendaciones, 
        alertas
    )
    
    return ProcesamientoCompletoOutput(
        analisis=analisis,
        recomendaciones=recomendaciones,
        alertas=alertas,
        decision=decision
    )
```

**L√≥gica de Decisi√≥n**:
```python
def tomar_decision_final(analisis, recomendaciones, alertas):
    if alertas.nivel_riesgo == "critico":
        return {
            "accion": "rechazar",
            "mensaje": "Solicitud bloqueada por seguridad"
        }
    
    if not recomendaciones.trabajadores:
        return {
            "accion": "esperar",
            "mensaje": "No hay t√©cnicos disponibles"
        }
    
    return {
        "accion": "aprobar",
        "trabajador_sugerido": recomendaciones.trabajadores[0],
        "mensaje": "Conexi√≥n recomendada con Carlos P√©rez"
    }
```

---

## üîó Integraci√≥n MCP (Model Context Protocol)

### ¬øQu√© es MCP?

**Model Context Protocol** es un protocolo estandarizado para que **modelos de IA se comuniquen con herramientas externas** (bases de datos, APIs, servicios).

### Arquitectura MCP en TaskPro

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  CLAUDE DESKTOP ‚îÇ  (Cliente MCP)
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ Protocolo MCP (stdio)
         ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   MCP SERVER    ‚îÇ  (mcp_server/server.py)
‚îÇ   TaskPro       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ HTTP REST
         ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  BACKEND API    ‚îÇ  (FastAPI)
‚îÇ  + Gemini LLM   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  PostgreSQL DB  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Herramientas Expuestas por MCP

**1. `analyze_solicitud`** (Tool)
```json
{
  "name": "analyze_solicitud",
  "description": "üîç Agente Analista: Interpreta solicitud...",
  "inputSchema": {
    "type": "object",
    "properties": {
      "texto_usuario": {"type": "string"}
    }
  }
}
```

**2. `create_solicitud`** (Tool)
```json
{
  "name": "create_solicitud",
  "description": "‚úçÔ∏è Agente Estructurador: Crea solicitud...",
  "inputSchema": {
    "type": "object",
    "properties": {
      "texto_usuario": {"type": "string"}
    }
  }
}
```

**3. `procesar_solicitud_completa`** (Tool)
```json
{
  "name": "procesar_solicitud_completa",
  "description": "üöÄ AGENTE ORQUESTADOR A2A: Pipeline completo...",
  "inputSchema": {
    "type": "object",
    "properties": {
      "texto_usuario": {"type": "string"},
      "id_ciudad": {"type": "integer"},
      "id_barrio": {"type": "integer"}
    }
  }
}
```

### Implementaci√≥n del Servidor MCP

**C√≥digo** (`mcp_server/server.py`):
```python
from mcp.server import Server
from mcp.server.stdio import stdio_server
from mcp import types

server = Server("taskpro-mcp-server")

@server.list_tools()
async def handle_list_tools() -> list[types.Tool]:
    """Registrar herramientas disponibles"""
    return [
        types.Tool(name="analyze_solicitud", ...),
        types.Tool(name="create_solicitud", ...),
        types.Tool(name="procesar_solicitud_completa", ...)
    ]

@server.call_tool()
async def handle_call_tool(
    name: str, 
    arguments: dict
) -> list[types.TextContent]:
    """Ejecutar herramienta solicitada"""
    
    if name == "analyze_solicitud":
        # Llamar al backend FastAPI
        async with httpx.AsyncClient() as client:
            response = await client.post(
                f"{BACKEND_URL}/solicitudes/analizar",
                json={"texto_usuario": arguments["texto_usuario"]}
            )
        return [types.TextContent(
            type="text",
            text=response.text
        )]
    
    # ... otras herramientas
```

---

## üîÆ Servicio LLM (Gemini Integration)

### Configuraci√≥n Multi-M√©todo

El sistema soporta **dos m√©todos de autenticaci√≥n** con Google Gemini:

**1. Vertex AI con ADC (Producci√≥n)**
```python
# Variables de entorno
GOOGLE_GENAI_USE_VERTEXAI=True
GOOGLE_CLOUD_PROJECT=primeval-falcon-474622-h1
GOOGLE_CLOUD_LOCATION=us-central1
GOOGLE_APPLICATION_CREDENTIALS=/config/gcloud-key.json
```

**2. API Key (Desarrollo)**
```python
GOOGLE_API_KEY=AIza...
```

### Function Calling con Gemini

**Definici√≥n de Herramienta**:
```python
class CrearSolicitudTool(BaseModel):
    id_oficio: int = Field(..., description="ID del oficio")
    urgencia: Literal['baja', 'media', 'alta']
    descripcion_usuario: str

# Configurar Gemini con tool
config = GenerateContentConfig(
    tools=[CrearSolicitudTool],
    temperature=0.7,
    response_mime_type="application/json"
)

# Llamada al modelo
response = client.models.generate_content(
    model='gemini-2.0-flash-exp',
    contents=prompt,
    config=config
)

# Parsear respuesta estructurada
resultado = CrearSolicitudTool(**response.parsed)
```

---

## üìä Base de Datos (PostgreSQL)

### Modelo Entidad-Relaci√≥n

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  SOLICITANTE ‚îÇ       ‚îÇ  SOLICITUD   ‚îÇ       ‚îÇ  TRABAJADOR  ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§       ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§       ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ id_usuario   ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ<‚îÇ id_solicitud ‚îÇ>‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ id_trabajador‚îÇ
‚îÇ nombre       ‚îÇ       ‚îÇ id_oficio    ‚îÇ       ‚îÇ nombre       ‚îÇ
‚îÇ telefono     ‚îÇ       ‚îÇ id_usuario   ‚îÇ       ‚îÇ telefono     ‚îÇ
‚îÇ email        ‚îÇ       ‚îÇ urgencia     ‚îÇ       ‚îÇ calificacion ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò       ‚îÇ estado       ‚îÇ       ‚îÇ experiencia  ‚îÇ
                       ‚îÇ precio       ‚îÇ       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò              ‚îÇ
                              ‚îÇ                      ‚îÇ
                       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                       ‚îÇ    OFICIO    ‚îÇ       ‚îÇ   SERVICIO   ‚îÇ
                       ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§       ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
                       ‚îÇ id_oficio    ‚îÇ       ‚îÇ id_servicio  ‚îÇ
                       ‚îÇ nombre       ‚îÇ       ‚îÇ id_trabajador‚îÇ
                       ‚îÇ categoria    ‚îÇ       ‚îÇ id_solicitud ‚îÇ
                       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò       ‚îÇ precio_final ‚îÇ
                                              ‚îÇ calificacion ‚îÇ
                                              ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Tablas Principales

**1. `oficios`**: Cat√°logo de servicios
```sql
CREATE TABLE oficios (
    id_oficio SERIAL PRIMARY KEY,
    nombre_oficio VARCHAR(100) NOT NULL,
    categoria_servicio VARCHAR(50),
    descripcion TEXT,
    precio_referencia_min DECIMAL,
    precio_referencia_max DECIMAL
);
```

**2. `solicitudes`**: Pedidos de usuarios
```sql
CREATE TABLE solicitudes (
    id_solicitud SERIAL PRIMARY KEY,
    id_oficio INTEGER REFERENCES oficios(id_oficio),
    id_usuario INTEGER REFERENCES solicitantes(id_usuario),
    descripcion_usuario TEXT,
    urgencia VARCHAR(20),
    estado VARCHAR(20),
    fecha_creacion TIMESTAMP DEFAULT NOW()
);
```

**3. `trabajadores`**: Perfiles de t√©cnicos
```sql
CREATE TABLE trabajadores (
    id_trabajador SERIAL PRIMARY KEY,
    nombre_completo VARCHAR(200),
    telefono VARCHAR(20),
    email VARCHAR(100),
    calificacion_promedio DECIMAL(3,2),
    cantidad_servicios INTEGER,
    anos_experiencia INTEGER,
    disponible BOOLEAN DEFAULT TRUE
);
```

---

# üé® FRONTEND - Interfaz de Usuario Moderna

## üìÇ Estructura del Frontend

```
frontend/
‚îú‚îÄ‚îÄ app/                      # Next.js App Router
‚îÇ   ‚îú‚îÄ‚îÄ page.tsx              # P√°gina principal (b√∫squeda)
‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx            # Layout global
‚îÇ   ‚îú‚îÄ‚îÄ globals.css           # Estilos globales + Tailwind
‚îÇ   ‚îú‚îÄ‚îÄ buscar/               # Flujo de b√∫squeda
‚îÇ   ‚îú‚îÄ‚îÄ resultados/           # Lista de t√©cnicos
‚îÇ   ‚îú‚îÄ‚îÄ tecnico/[id]/         # Perfil detallado
‚îÇ   ‚îú‚îÄ‚îÄ dashboard-tecnico/    # Panel t√©cnico
‚îÇ   ‚îî‚îÄ‚îÄ registro-tecnico/     # Onboarding t√©cnico
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ navigation.tsx        # Barra de navegaci√≥n
‚îÇ   ‚îú‚îÄ‚îÄ technician-results.tsx # Card de t√©cnico
‚îÇ   ‚îî‚îÄ‚îÄ ui/                   # Componentes Radix UI
‚îÇ       ‚îú‚îÄ‚îÄ button.tsx
‚îÇ       ‚îú‚îÄ‚îÄ card.tsx
‚îÇ       ‚îú‚îÄ‚îÄ dialog.tsx
‚îÇ       ‚îî‚îÄ‚îÄ ... (50+ componentes)
‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îú‚îÄ‚îÄ utils.ts              # Helpers (cn, formatters)
‚îÇ   ‚îî‚îÄ‚îÄ mock-data.ts          # Datos de prueba
‚îú‚îÄ‚îÄ hooks/
‚îÇ   ‚îú‚îÄ‚îÄ use-toast.ts          # Notificaciones
‚îÇ   ‚îî‚îÄ‚îÄ use-mobile.ts         # Detecci√≥n responsive
‚îî‚îÄ‚îÄ public/                   # Assets est√°ticos
```

---

## üé® Sistema de Dise√±o

### Paleta de Colores (Inspirada en Globant)

El frontend utiliza **colores vibrantes** con √©nfasis en **lima brillante** (#B4FE00) y **negro profundo**.

**Definici√≥n en CSS** (`globals.css`):
```css
:root {
  /* Primary: Globant signature lime green */
  --primary: oklch(0.92 0.25 130);        /* #B4FE00 */
  --primary-foreground: oklch(0.1 0.01 120); /* Texto oscuro */
  
  /* Secondary: Deep black for contrast */
  --secondary: oklch(0.15 0.01 120);      /* Negro */
  --secondary-foreground: oklch(0.99 0 0); /* Blanco */
  
  /* Accent: Bright lime for highlights */
  --accent: oklch(0.85 0.22 130);
  
  /* Backgrounds */
  --background: oklch(0.99 0.002 120);    /* Blanco crema */
  --card: oklch(1 0 0);                   /* Blanco puro */
  
  /* Interactive */
  --ring: oklch(0.92 0.25 130);           /* Focus ring lime */
  --radius: 0.75rem;                      /* Border radius */
}

.dark {
  --background: oklch(0.1 0.01 120);      /* Negro */
  --foreground: oklch(0.95 0.01 130);     /* Blanco */
  --primary: oklch(0.92 0.25 130);        /* Lime mantiene */
}
```

### Tipograf√≠a
- **Font**: `Inter` (sans-serif moderna)
- **Escala**: Base 16px, responsive con `clamp()`
- **Pesos**: Regular (400), Medium (500), Semibold (600), Bold (700)

---

## ‚öõÔ∏è Stack Tecnol√≥gico Frontend

### Core Framework
- **Next.js 15.5.6**: React Framework con App Router
- **React 18**: Librer√≠a de UI
- **TypeScript**: Tipado est√°tico

### Librer√≠a de Componentes
- **Radix UI**: Primitivos accesibles (50+ componentes)
  - Accordion, Dialog, Dropdown, Popover, etc.
- **Tailwind CSS 4**: Utility-first CSS
- **tw-animate-css**: Animaciones predefinidas
- **class-variance-authority**: Variantes de componentes
- **clsx**: Composici√≥n de clases CSS

### Gesti√≥n de Estado
- **React Hooks**: useState, useEffect, useContext
- **React Hook Form**: Formularios complejos
- **Zod**: Validaci√≥n de schemas

### Iconograf√≠a
- **Lucide React**: 1000+ iconos SVG optimizados
  - Ejemplos: `<Search />`, `<Zap />`, `<Shield />`

---

## üåä Flujo de Usuario Frontend

### 1. **P√°gina Principal** (`app/page.tsx`)

**Caracter√≠sticas**:
- **Hero section** con b√∫squeda prominente
- **Textarea** para lenguaje natural
- **Call to action** animado con gradientes
- **Feature cards** (IA, Verificaci√≥n, Recomendaciones)

**C√≥digo clave**:
```tsx
export default function HomePage() {
  const [problem, setProblem] = useState("")
  const router = useRouter()

  const handleSearch = () => {
    if (problem.trim()) {
      // Redirigir a resultados con query
      router.push(`/resultados?q=${encodeURIComponent(problem)}`)
    }
  }

  return (
    <div className="relative overflow-hidden">
      {/* Hero con gradiente lime */}
      <div className="absolute inset-0 bg-gradient-to-br 
                      from-primary/10 via-background to-accent/5" />
      
      {/* Buscador principal */}
      <div className="relative z-10 container mx-auto px-4 py-24">
        <h1 className="text-5xl font-bold mb-6 
                       bg-gradient-to-r from-primary to-accent 
                       bg-clip-text text-transparent">
          Encuentra al T√©cnico Perfecto
        </h1>
        
        <Textarea
          placeholder="Ej: Necesito un plomero urgente, se rompi√≥ mi inodoro"
          value={problem}
          onChange={(e) => setProblem(e.target.value)}
          className="min-h-32 text-lg"
        />
        
        <Button 
          onClick={handleSearch}
          size="lg"
          className="mt-4 bg-primary hover:bg-primary/90">
          <Search className="mr-2" />
          Buscar T√©cnicos
        </Button>
      </div>
    </div>
  )
}
```

---

### 2. **P√°gina de Resultados** (`app/resultados/page.tsx`)

**Caracter√≠sticas**:
- **Llamada as√≠ncrona** al endpoint `/solicitudes/procesar-completa`
- **Loading state** con skeletons animados
- **Lista de t√©cnicos** rankeados con scores
- **Filtros laterales** (precio, distancia, calificaci√≥n)

**Flujo de datos**:
```tsx
export default function ResultadosPage({ searchParams }) {
  const [loading, setLoading] = useState(true)
  const [tecnicos, setTecnicos] = useState([])
  const [analisis, setAnalisis] = useState(null)

  useEffect(() => {
    async function fetchResults() {
      const response = await fetch('/api/backend/solicitudes/procesar-completa', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          texto_usuario: searchParams.q,
          id_ciudad: 1,
          id_barrio: 10
        })
      })
      
      const data = await response.json()
      setAnalisis(data.analisis)
      setTecnicos(data.recomendaciones.trabajadores_recomendados)
      setLoading(false)
    }
    
    fetchResults()
  }, [searchParams.q])

  if (loading) return <TechnicianResultsSkeleton />

  return (
    <div className="grid grid-cols-1 lg:grid-cols-4 gap-6">
      {/* Filtros laterales */}
      <aside className="lg:col-span-1">
        <FilterPanel analisis={analisis} />
      </aside>
      
      {/* Lista de t√©cnicos */}
      <main className="lg:col-span-3">
        <AnalysisSummary analisis={analisis} />
        <TechnicianList tecnicos={tecnicos} />
      </main>
    </div>
  )
}
```

---

### 3. **Componente TechnicianCard** (`components/technician-results.tsx`)

**Dise√±o**:
- **Card con hover effect** (escala + sombra)
- **Avatar con badge** de disponibilidad
- **Rating con estrellas** animadas
- **Badges**: Distancia, Precio, Experiencia
- **CTA button** lime con iconos

**C√≥digo**:
```tsx
import { Card, CardContent } from "@/components/ui/card"
import { Badge } from "@/components/ui/badge"
import { Button } from "@/components/ui/button"
import { Star, MapPin, DollarSign } from "lucide-react"

export function TechnicianCard({ tecnico }) {
  return (
    <Card className="hover:scale-102 hover:shadow-xl transition-all duration-300
                     border-2 hover:border-primary/50">
      <CardContent className="p-6">
        <div className="flex items-start gap-4">
          {/* Avatar */}
          <div className="relative">
            <Avatar className="h-16 w-16 border-2 border-primary">
              <AvatarImage src={tecnico.foto} />
              <AvatarFallback className="bg-primary text-primary-foreground">
                {tecnico.nombre[0]}
              </AvatarFallback>
            </Avatar>
            {tecnico.disponible && (
              <div className="absolute -bottom-1 -right-1 h-5 w-5 
                              bg-green-500 rounded-full border-2 border-white" />
            )}
          </div>
          
          {/* Info */}
          <div className="flex-1">
            <h3 className="text-xl font-semibold">{tecnico.nombre}</h3>
            
            {/* Rating */}
            <div className="flex items-center gap-1 mt-1">
              {Array.from({ length: 5 }).map((_, i) => (
                <Star 
                  key={i} 
                  className={`h-4 w-4 ${
                    i < Math.floor(tecnico.calificacion_promedio)
                      ? 'fill-yellow-400 text-yellow-400'
                      : 'text-gray-300'
                  }`} 
                />
              ))}
              <span className="ml-2 text-sm text-muted-foreground">
                {tecnico.calificacion_promedio} ({tecnico.total_resenas} rese√±as)
              </span>
            </div>
            
            {/* Badges */}
            <div className="flex gap-2 mt-3">
              <Badge variant="secondary" className="gap-1">
                <MapPin className="h-3 w-3" />
                {tecnico.distancia_km} km
              </Badge>
              <Badge variant="secondary" className="gap-1">
                <DollarSign className="h-3 w-3" />
                {tecnico.precio_promedio}
              </Badge>
              <Badge variant="outline">
                {tecnico.anos_experiencia} a√±os exp.
              </Badge>
            </div>
            
            {/* CTA */}
            <Button className="mt-4 w-full bg-primary hover:bg-primary/90">
              Ver Perfil Completo
            </Button>
          </div>
        </div>
      </CardContent>
    </Card>
  )
}
```

---

## üé≠ Animaciones y Efectos

### Hover Effects
```css
.card-hover {
  @apply transition-all duration-300 hover:scale-102 hover:shadow-2xl;
}
```

### Loading Skeletons
```tsx
import { Skeleton } from "@/components/ui/skeleton"

export function TechnicianResultsSkeleton() {
  return (
    <div className="space-y-4">
      {Array.from({ length: 5 }).map((_, i) => (
        <Card key={i} className="p-6">
          <div className="flex gap-4">
            <Skeleton className="h-16 w-16 rounded-full" />
            <div className="flex-1 space-y-2">
              <Skeleton className="h-6 w-1/3" />
              <Skeleton className="h-4 w-1/2" />
              <Skeleton className="h-4 w-2/3" />
            </div>
          </div>
        </Card>
      ))}
    </div>
  )
}
```

### Gradientes Vibrantes
```css
/* Gradiente lime ‚Üí amarillo */
.gradient-primary {
  background: linear-gradient(135deg, 
    oklch(0.92 0.25 130) 0%, 
    oklch(0.85 0.22 130) 100%
  );
}

/* Texto con gradiente */
.text-gradient {
  @apply bg-gradient-to-r from-primary to-accent 
         bg-clip-text text-transparent;
}
```

---

## üì± Responsive Design

### Breakpoints (Tailwind)
```typescript
const screens = {
  sm: '640px',   // Mobile landscape
  md: '768px',   // Tablet
  lg: '1024px',  // Desktop
  xl: '1280px',  // Large desktop
  '2xl': '1536px' // Ultra wide
}
```

### Ejemplo de Layout Adaptativo
```tsx
<div className="
  grid 
  grid-cols-1         /* Mobile: 1 columna */
  md:grid-cols-2      /* Tablet: 2 columnas */
  lg:grid-cols-3      /* Desktop: 3 columnas */
  gap-4 md:gap-6
">
  {tecnicos.map(t => <TechnicianCard key={t.id} tecnico={t} />)}
</div>
```

---

## üåô Modo Oscuro

**Implementaci√≥n con next-themes**:
```tsx
// app/layout.tsx
import { ThemeProvider } from "@/components/theme-provider"

export default function RootLayout({ children }) {
  return (
    <html lang="es" suppressHydrationWarning>
      <body>
        <ThemeProvider
          attribute="class"
          defaultTheme="system"
          enableSystem
          disableTransitionOnChange
        >
          {children}
        </ThemeProvider>
      </body>
    </html>
  )
}

// components/theme-toggle.tsx
import { Moon, Sun } from "lucide-react"
import { useTheme } from "next-themes"

export function ThemeToggle() {
  const { theme, setTheme } = useTheme()
  
  return (
    <Button
      variant="ghost"
      size="icon"
      onClick={() => setTheme(theme === "dark" ? "light" : "dark")}
    >
      <Sun className="h-5 w-5 rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0" />
      <Moon className="absolute h-5 w-5 rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100" />
    </Button>
  )
}
```

---

## üîÑ Integraci√≥n Frontend ‚Üî Backend

### Proxy de API (Next.js)

**Configuraci√≥n** (`next.config.mjs`):
```javascript
const nextConfig = {
  async rewrites() {
    return [
      {
        source: '/api/backend/:path*',
        destination: 'http://backend:8000/:path*'
      }
    ]
  }
}
```

### Cliente HTTP
```typescript
// lib/api-client.ts
export async function procesarSolicitud(textoUsuario: string) {
  const response = await fetch('/api/backend/solicitudes/procesar-completa', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      texto_usuario: textoUsuario,
      id_ciudad: 1,
      id_barrio: 10
    })
  })
  
  if (!response.ok) {
    throw new Error(`Error ${response.status}: ${response.statusText}`)
  }
  
  return response.json()
}
```

---

## üöÄ Despliegue y Performance

### Optimizaciones
1. **Code Splitting**: Carga componentes bajo demanda
2. **Image Optimization**: Next.js Image component
3. **Server Components**: Render en servidor cuando sea posible
4. **Caching**: SWR para datos de API

### Build Production
```bash
# Compilar frontend
cd frontend
pnpm build

# Output: .next/ (optimizado para producci√≥n)
# Tama√±o t√≠pico: ~500KB initial bundle
```

---

## üìä Resumen Comparativo Backend vs Frontend

| Aspecto | Backend | Frontend |
|---------|---------|----------|
| **Lenguaje** | Python 3.11 | TypeScript 5.x |
| **Framework** | FastAPI | Next.js 15 |
| **Base de Datos** | PostgreSQL | N/A (consume API) |
| **IA/LLM** | Gemini 2.0 Flash | N/A (UX de resultados) |
| **Arquitectura** | Agentes A2A + MCP | Componentes React |
| **Protocolo** | REST + MCP stdio | HTTP/REST |
| **Estilos** | N/A | Tailwind + Radix UI |
| **Testing** | pytest | Jest + React Testing Library |
| **Deploy** | Docker + Uvicorn | Docker + Node 20 |

---

## üéØ Flujo End-to-End Completo

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 1. USUARIO escribe: "Necesito plomero urgente, inodoro roto"    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                        ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 2. FRONTEND (Next.js) captura input y env√≠a POST                 ‚îÇ
‚îÇ    ‚Üí /api/backend/solicitudes/procesar-completa                  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                        ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 3. BACKEND (FastAPI) recibe request                              ‚îÇ
‚îÇ    ‚Üí Llama a procesar_solicitud_completa()                       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                        ‚îÇ
         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
         ‚îÇ                             ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 4a. AGENTE        ‚îÇ         ‚îÇ 4b. CONSULTA DB   ‚îÇ
‚îÇ     ANALISTA      ‚îÇ         ‚îÇ     PostgreSQL    ‚îÇ
‚îÇ (Gemini LLM)      ‚îÇ         ‚îÇ  ‚Ä¢ Oficios        ‚îÇ
‚îÇ ‚Ä¢ Clasifica       ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§  ‚Ä¢ Trabajadores   ‚îÇ
‚îÇ ‚Ä¢ Extrae urgencia ‚îÇ         ‚îÇ  ‚Ä¢ Tarifas        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 5. AGENTE         ‚îÇ
‚îÇ    RECOMENDADOR   ‚îÇ
‚îÇ ‚Ä¢ Filtra por      ‚îÇ
‚îÇ   ubicaci√≥n       ‚îÇ
‚îÇ ‚Ä¢ Rankea por      ‚îÇ
‚îÇ   score           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 6. AGENTE         ‚îÇ
‚îÇ    GUARDI√ÅN       ‚îÇ
‚îÇ (Gemini LLM)      ‚îÇ
‚îÇ ‚Ä¢ Detecta alertas ‚îÇ
‚îÇ ‚Ä¢ Valida precios  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 7. ORQUESTADOR    ‚îÇ
‚îÇ ‚Ä¢ Agrega          ‚îÇ
‚îÇ   resultados      ‚îÇ
‚îÇ ‚Ä¢ Toma decisi√≥n   ‚îÇ
‚îÇ ‚Ä¢ Formatea JSON   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 8. RESPUESTA JSON                                      ‚îÇ
‚îÇ {                                                      ‚îÇ
‚îÇ   "analisis": { oficio: "Plomero", urgencia: "alta" } ‚îÇ
‚îÇ   "recomendaciones": [ {Carlos, 4.9‚≠ê, 2km} ],        ‚îÇ
‚îÇ   "alertas": [],                                       ‚îÇ
‚îÇ   "decision": { accion: "aprobar", tecnico: Carlos }  ‚îÇ
‚îÇ }                                                      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 9. FRONTEND renderiza:                                 ‚îÇ
‚îÇ    ‚Ä¢ Card de Carlos con avatar y rating               ‚îÇ
‚îÇ    ‚Ä¢ Bot√≥n "Contactar" lime con animaci√≥n             ‚îÇ
‚îÇ    ‚Ä¢ Badge "Disponible Ahora" verde pulsante          ‚îÇ
‚îÇ    ‚Ä¢ Precio estimado: $50-100                         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üéì Conceptos Clave A2A Explicados

### ¬øPor qu√© A2A (Agent to Agent)?

**Problema tradicional**:
- Un solo modelo LLM intenta hacer todo
- Prompts gigantes y confusos
- Errores dif√≠ciles de debuggear
- No escalable

**Soluci√≥n A2A**:
- **Agentes especializados** con roles claros
- **Comunicaci√≥n estructurada** mediante JSON
- **Pipeline modular** f√°cil de mantener
- **Responsabilidades separadas**

### Ventajas del Dise√±o

1. **Modularidad**: Cambiar un agente sin afectar otros
2. **Testabilidad**: Probar cada agente aisladamente
3. **Escalabilidad**: Agregar nuevos agentes f√°cilmente
4. **Transparencia**: Ver decisi√≥n de cada agente
5. **Fallbacks**: Si un agente falla, otros contin√∫an

### Ejemplo Real de Comunicaci√≥n

```python
# Agente Analista devuelve:
{
  "id_oficio": 5,
  "urgencia": "alta",
  "precio_estimado": "$50-100"
}

# ‚Üì Pasa a Agente Recomendador ‚Üì

# Agente Recomendador recibe y usa:
trabajadores = buscar_por_oficio(id_oficio=5)
if urgencia == "alta":
    trabajadores = filtrar_disponibles(trabajadores)

# ‚Üì Pasa a Agente Guardi√°n ‚Üì

# Agente Guardi√°n valida:
for trabajador in trabajadores:
    if trabajador.precio > 2 * precio_estimado:
        alertar("precio_anomalo")
```

---

## üìö Tecnolog√≠as y Herramientas

### Backend
- **FastAPI**: Framework web as√≠ncrono
- **SQLAlchemy**: ORM para PostgreSQL
- **Pydantic**: Validaci√≥n de datos
- **Google Gemini SDK**: LLM integration
- **MCP SDK**: Protocol implementation
- **httpx**: Cliente HTTP as√≠ncrono
- **python-dotenv**: Variables de entorno

### Frontend
- **Next.js**: React framework con SSR
- **TypeScript**: Tipado est√°tico
- **Tailwind CSS**: Utility-first CSS
- **Radix UI**: Componentes accesibles
- **Lucide React**: Iconos SVG
- **React Hook Form**: Gesti√≥n de formularios
- **Zod**: Validaci√≥n de schemas
- **next-themes**: Modo oscuro

### DevOps
- **Docker**: Containerizaci√≥n
- **Docker Compose**: Orquestaci√≥n
- **PostgreSQL 16**: Base de datos
- **Nginx**: Reverse proxy (producci√≥n)

---

## üîí Seguridad y Buenas Pr√°cticas

### Backend
- ‚úÖ Validaci√≥n de entrada con Pydantic
- ‚úÖ SQL Injection prevention (SQLAlchemy ORM)
- ‚úÖ Rate limiting en endpoints cr√≠ticos
- ‚úÖ CORS configurado restrictivamente
- ‚úÖ Secrets en variables de entorno

### Frontend
- ‚úÖ Sanitizaci√≥n de inputs
- ‚úÖ CSP (Content Security Policy)
- ‚úÖ HTTPS obligatorio en producci√≥n
- ‚úÖ Validaci√≥n client-side con Zod
- ‚úÖ Tokens CSRF en formularios

---

## üöÄ Conclusi√≥n

**TaskPro** demuestra una **arquitectura moderna de IA** que combina:

1. **Backend inteligente** con agentes especializados A2A
2. **Integraci√≥n MCP** para extensibilidad
3. **LLMs potentes** (Gemini) con Function Calling
4. **Frontend vibrante** con React y dise√±o Globant
5. **Flujo end-to-end** optimizado para UX

El sistema no solo conecta usuarios con t√©cnicos, sino que lo hace con **inteligencia contextual**, **seguridad proactiva** y **experiencia de usuario excepcional**.

---

**Desarrollado con üíö (color lime) y IA**
